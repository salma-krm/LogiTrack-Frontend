<div class="inventory-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-left">
      <h1>üì¶ Gestion des Inventaires</h1>
    </div>
    <button class="btn btn-primary" (click)="openAddModal()">
      <span>+</span> Nouvel Inventaire
    </button>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">üìä</div>
      <div class="stat-content">
        <div class="stat-value">{{ totalInventories }}</div>
        <div class="stat-label">Total Inventaires</div>
      </div>
    </div>
    <div class="stat-card warning">
      <div class="stat-icon">‚ö†Ô∏è</div>
      <div class="stat-content">
        <div class="stat-value">{{ lowStock }}</div>
        <div class="stat-label">Stock Faible</div>
      </div>
    </div>
    <div class="stat-card danger">
      <div class="stat-icon">‚ùå</div>
      <div class="stat-content">
        <div class="stat-value">{{ outOfStock }}</div>
        <div class="stat-label">Rupture</div>
      </div>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="search-box">
      <input
        type="text"
        class="form-control"
        placeholder="üîç Rechercher..."
        [(ngModel)]="searchTerm"
        (input)="applyFilters()"
      />
    </div>
    <select class="form-control filter-select" [(ngModel)]="warehouseFilter" (change)="applyFilters()">
      <option value="">üì¶ Tous les entrep√¥ts</option>
      <option *ngFor="let warehouse of warehouses" [value]="warehouse.id">{{ warehouse.name }}</option>
    </select>
    <select class="form-control filter-select" [(ngModel)]="productFilter" (change)="applyFilters()">
      <option value="">üîß Tous les produits</option>
      <option *ngFor="let product of products" [value]="product.id">{{ product.name }}</option>
    </select>
    <button class="btn btn-secondary" (click)="resetFilters()">R√©initialiser</button>
  </div>

  <!-- Table Section -->
  <div class="table-container">
    <table class="inventory-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>PRODUIT</th>
          <th>ENTREP√îT</th>
          <th>QT√â EN STOCK</th>
          <th>QT√â R√âSERV√âE</th>
          <th>DISPONIBLE</th>
          <th>STATUT</th>
          <th>ACTIONS</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let inventory of filteredInventories">
          <td class="id-col">{{ inventory.id }}</td>
          <td>
            <div class="product-info">
              <div class="product-name">{{ inventory.productName }}</div>
            </div>
          </td>
          <td>
            <span class="warehouse-badge">{{ inventory.warehouseName }}</span>
          </td>
          <td class="quantity-col">{{ inventory.quantityInStock }}</td>
          <td class="reserved-col">{{ inventory.reservedQuantity }}</td>
          <td class="available-col">{{ inventory.availableQuantity }}</td>
          <td>
            <span class="badge" [ngClass]="getStatusClass(inventory)">
              {{ getStatusLabel(inventory) }}
            </span>
          </td>
          <td>
            <div class="actions">
              <button class="btn btn-primary btn-sm" (click)="openEditModal(inventory)">
                ‚úèÔ∏è
              </button>
              <button class="btn btn-danger btn-sm" (click)="deleteInventory(inventory.id)">
                üóëÔ∏è
              </button>
            </div>
          </td>
        </tr>
        <tr *ngIf="filteredInventories.length === 0">
          <td colspan="8" class="no-data">Aucun inventaire trouv√©</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal for Add/Edit Inventory -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ isEditMode ? 'Modifier l\'Inventaire' : 'Nouvel Inventaire' }}</h3>
      <button class="close-btn" (click)="closeModal()">√ó</button>
    </div>
    <div class="modal-body">
      <form>
        <div class="form-group">
          <label>Produit</label>
          <select class="form-control" [(ngModel)]="currentInventory.productId" name="productId">
            <option value="">S√©lectionner un produit</option>
            <option *ngFor="let product of products" [value]="product.id">{{ product.name }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Entrep√¥t</label>
          <select class="form-control" [(ngModel)]="currentInventory.warehouseId" name="warehouseId">
            <option value="">S√©lectionner un entrep√¥t</option>
            <option *ngFor="let warehouse of warehouses" [value]="warehouse.id">{{ warehouse.name }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Quantit√© en Stock</label>
          <input type="number" class="form-control" [(ngModel)]="currentInventory.quantityInStock" name="quantityInStock" />
        </div>
        <div class="form-group">
          <label>Quantit√© R√©serv√©e</label>
          <input type="number" class="form-control" [(ngModel)]="currentInventory.reservedQuantity" name="reservedQuantity" />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Annuler</button>
      <button class="btn btn-primary" (click)="saveInventory()">
        {{ isEditMode ? 'Mettre √† jour' : 'Ajouter' }}
      </button>
    </div>
  </div>
</div>
